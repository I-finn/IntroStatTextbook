<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Confidence intervals with bootstrapping | Montana State Introductory Statistics with R</title>
<meta name="author" content="Nicole Carnegie, Stacey Hancock, Elijah Meyer, Jade Schmidt, Melinda Yager">
<meta name="description" content="In this chapter, we expand on the familiar idea of using a sample proportion to estimate a population proportion. That is, we create what is called a confidence interval, which is a range of...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 10 Confidence intervals with bootstrapping | Montana State Introductory Statistics with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mtstateintrostats.github.io/IntroStatTextbook/foundations-bootstrapping.html">
<meta property="og:description" content="In this chapter, we expand on the familiar idea of using a sample proportion to estimate a population proportion. That is, we create what is called a confidence interval, which is a range of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Confidence intervals with bootstrapping | Montana State Introductory Statistics with R">
<meta name="twitter:description" content="In this chapter, we expand on the familiar idea of using a sample proportion to estimate a population proportion. That is, we create what is called a confidence interval, which is a range of...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Montana State Introductory Statistics with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="authors.html">Authors</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="rstudio.html">Preliminaries: Getting started in RStudio</a></li>
<li class="book-part">Introduction to data</li>
<li><a class="" href="data-hello.html"><span class="header-section-number">1</span> Hello data</a></li>
<li><a class="" href="data-design.html"><span class="header-section-number">2</span> Study design</a></li>
<li><a class="" href="data-applications.html"><span class="header-section-number">3</span> Applications: Data</a></li>
<li class="book-part">Exploratory data analysis</li>
<li><a class="" href="explore-categorical.html"><span class="header-section-number">4</span> Exploring categorical data</a></li>
<li><a class="" href="explore-numerical.html"><span class="header-section-number">5</span> Exploring quantitative data</a></li>
<li><a class="" href="explore-regression.html"><span class="header-section-number">6</span> Correlation and regression</a></li>
<li><a class="" href="explore-mult-reg.html"><span class="header-section-number">7</span> Multivariable models</a></li>
<li><a class="" href="explore-applications.html"><span class="header-section-number">8</span> Applications: Explore</a></li>
<li class="book-part">Foundations of inference</li>
<li><a class="" href="foundations-randomization.html"><span class="header-section-number">9</span> Hypothesis testing with randomization</a></li>
<li><a class="active" href="foundations-bootstrapping.html"><span class="header-section-number">10</span> Confidence intervals with bootstrapping</a></li>
<li><a class="" href="foundations-mathematical.html"><span class="header-section-number">11</span> Inference with mathematical models</a></li>
<li><a class="" href="foundations-errors.html"><span class="header-section-number">12</span> Errors, power, and practical importance</a></li>
<li><a class="" href="foundations-applications.html"><span class="header-section-number">13</span> Applications: Foundations</a></li>
<li class="book-part">Inference for categorical data</li>
<li><a class="" href="inference-one-prop.html"><span class="header-section-number">14</span> Inference for a single proportion</a></li>
<li><a class="" href="inference-two-props.html"><span class="header-section-number">15</span> Inference for comparing two proportions</a></li>
<li><a class="" href="inference-categ-applications.html"><span class="header-section-number">16</span> Applications: Infer categorical</a></li>
<li class="book-part">Inference for quantitative data</li>
<li><a class="" href="inference-one-mean.html"><span class="header-section-number">17</span> Inference for a single mean</a></li>
<li><a class="" href="inference-paired-means.html"><span class="header-section-number">18</span> Inference for comparing paired means</a></li>
<li><a class="" href="inference-two-means.html"><span class="header-section-number">19</span> Inference for comparing two independent means</a></li>
<li><a class="" href="inference-num-applications.html"><span class="header-section-number">20</span> Applications: Infer quantitative</a></li>
<li class="book-part">Inference for regression</li>
<li><a class="" href="inference-reg.html"><span class="header-section-number">21</span> Inference for correlation and slope</a></li>
<li><a class="" href="inference-reg-applications.html"><span class="header-section-number">22</span> Applications: Infer regression</a></li>
<li class="book-part">Probability</li>
<li><a class="" href="probability.html"><span class="header-section-number">23</span> Probability with tables</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/MTstateIntroStats/IntroStatTextbook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="foundations-bootstrapping" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Confidence intervals with bootstrapping<a class="anchor" aria-label="anchor" href="#foundations-bootstrapping"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>In this chapter, we expand on the familiar idea of using a sample proportion to estimate a population proportion.
That is, we create what is called a <strong>confidence interval</strong>, which is a range of plausible values where we may find the true population value.
The process for creating a confidence interval is based on understanding how a statistic (here the sample proportion) <em>varies</em> around the parameter (here the population proportion) when many different statistics are calculated from many different samples.</p>
<p>If we could, we would measure the variability of the statistics by repeatedly taking sample data from the population and compute the sample proportion.
Then we could do it again.
And again.
And so on until we have a good sense of the variability of our original estimate.</p>
<p>When the variability across the samples is large, we would assume that the original statistic is possibly far from the true population parameter of interest (and the interval estimate will be wide).
When the variability across the samples is small, we expect the sample statistic to be close to the true parameter of interest (and the interval estimate will be narrow).</p>
<p>The ideal world where sampling data is free or extremely cheap is almost never the case, and taking repeated samples from a population is usually impossible.</p>
<p>So, instead of using a “resample from the population” approach, bootstrapping uses a “resample from the sample” approach.
In this chapter we provide examples and details about the bootstrapping process.</p>
</div>
<p>In Chapter <a href="foundations-randomization.html#foundations-randomization">9</a>, we explored how to use simulation methods
to model variability in sample statistics under the assumption of a null hypothesis.
Sometimes, however, instead of testing a claim, the goal is to estimate the unknown
value of a population parameter with a certain degree of certainty.</p>
<p>For example,</p>
<ul>
<li>How much less likely am I to get malaria if I get the vaccine?</li>
<li>How much faster (or slower) can a person tap their finger, on average, if they drink caffeine first?</li>
<li>What proportion of the vote will go to candidate A?</li>
</ul>
<p>Here, we explore the situation where the focus is on a single proportion, and we introduce a new simulation method: <strong>bootstrapping</strong>.</p>
<p>Bootstrapping is best suited for modeling studies where the data have been generated through random sampling from a population.</p>
<p>As with randomization tests, our goal with bootstrapping is to understand variability of a statistic.</p>
<p>Unlike randomization tests (which modeled how the statistic would change if the treatment had been allocated differently), the bootstrap will model how a statistic varies from one sample to another taken from the population.
This will provide information about how different the statistic is from the parameter of interest.</p>
<p>Quantifying the variability of a statistic from sample to sample is a hard problem.</p>
<p>Fortunately, sometimes the mathematical theory for how a statistic varies (across different samples) is well-known; this is the case for the sample proportion as seen in Chapter <a href="foundations-mathematical.html#foundations-mathematical">11</a>.</p>
<p>However, some statistics do not have simple theory for how they vary, and bootstrapping provides a computational approach for providing interval estimates for almost any population parameter.
In this chapter we will focus on bootstrapping to estimate a single proportion, and we will revisit bootstrapping in Chapters <a href="inference-one-mean.html#inference-one-mean">17</a> through <a href="inference-paired-means.html#inference-paired-means">18</a>, so you’ll get plenty of practice as well as exposure to bootstrapping in many different data settings.</p>
<p>Our goal with bootstrapping will be to produce an interval estimate (a range of plausible values) for the population parameter.</p>
<div id="case-study-med-consult" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Case study: Medical consultant<a class="anchor" aria-label="anchor" href="#case-study-med-consult"><i class="fas fa-link"></i></a>
</h2>
<p>People providing an organ for donation sometimes seek the help of a special medical consultant.
These consultants assist the patient in all aspects of the surgery, with the goal of reducing the possibility of complications during the medical procedure and recovery.
Patients might choose a consultant based in part on the historical complication rate of the consultant’s clients.</p>
<div id="observed-data-2" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> Observed data<a class="anchor" aria-label="anchor" href="#observed-data-2"><i class="fas fa-link"></i></a>
</h3>
<p>One consultant tried to attract patients by noting the average complication rate for liver donor surgeries in the US is about 10%, but her clients have had only 3 complications in the 62 liver donor surgeries she has facilitated.
She claims this is strong evidence that her work meaningfully contributes to reducing complications (and therefore she should be hired!).</p>
<div class="workedexample">
<p>We will let <span class="math inline">\(\pi\)</span> represent the true complication rate for liver donors working with this consultant.
(The “true” complication rate will be referred to as the <strong>parameter</strong>.) We estimate <span class="math inline">\(\pi\)</span> using the data, and label the estimate <span class="math inline">\(\hat{p}.\)</span></p>
<hr>
<p>The sample proportion for the complication rate is 3 complications divided by the 62 surgeries the consultant has worked on: <span class="math inline">\(\hat{p} = 3/62 = 0.048.\)</span></p>
</div>
<div class="workedexample">
<p>Is it possible to assess the consultant’s claim (that the reduction in complications is due to her work) using the data?</p>
<hr>
<p>No.</p>
<p>The claim is that there is a causal connection, but the data are observational, so we must be on the lookout for confounding variables.</p>
<p>For example, maybe patients who can afford a medical consultant can afford better medical care, which can also lead to a lower complication rate.</p>
<p>While it is not possible to assess the causal claim, it is still possible to understand the consultant’s true rate of complications.</p>
</div>
<div class="onebox">
<p><strong>Parameter.</strong></p>
<p>A <strong>parameter</strong> is the “true” value of interest.</p>
<p>We typically estimate the parameter using a point estimate from a sample of data.
The point estimate is also known as the <strong>statistic</strong>.</p>
<p>For example, we estimate the probability <span class="math inline">\(\pi\)</span> of a complication for a client of the medical consultant by examining the past complications rates of her clients:</p>
<p><span class="math display">\[\hat{p} = 3 / 62 = 0.048~\text{is used to estimate}~\pi\]</span></p>
</div>
</div>
<div id="variability-of-the-statistic-1" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Variability of the statistic<a class="anchor" aria-label="anchor" href="#variability-of-the-statistic-1"><i class="fas fa-link"></i></a>
</h3>
<p>In the medical consultant case study, the parameter is <span class="math inline">\(\pi,\)</span> the true probability of a complication for a client of the medical consultant.
There is no reason to believe that <span class="math inline">\(\pi\)</span> is exactly <span class="math inline">\(\hat{p} = 3/62,\)</span> but there is also no reason to believe that <span class="math inline">\(\pi\)</span> is particularly far from <span class="math inline">\(\hat{p} = 3/62.\)</span>
By sampling with replacement from the dataset (a process called bootstrapping), the variability of the possible <span class="math inline">\(\hat{p}\)</span> values can be approximated.</p>
<p>Most of the inferential procedures covered in this text are grounded in quantifying how one dataset would differ from another when they are both taken from the same population.
It does not make sense to take repeated samples from the same population because if you have the means to take more samples, a larger sample size will benefit you more than separately evaluating two sample of the exact same size.
Instead, we measure how the samples behave under an estimate of the population.</p>
<p>Figure <a href="foundations-bootstrapping.html#fig:boot1">10.1</a> shows how the unknown original population can be estimated by using the sample to approximate the proportion of successes and failures (in our case, the proportion of complications and no complications for the medical consultant).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boot1"></span>
<img src="images/boot1prop1.png" alt="A small sample of 3 red marbles and 4 white marbles is taken from a large population with predominately unknown individual values.  The sample is then replicated infinitely many times to create a proxy population where the values are known to be 3/7 red and 4/7 white." width="75%"><p class="caption">
Figure 10.1: The unknown population is estimated using the observed sample data. Note that we can use the sample to create an estimated or bootstrapped population from which to sample. The observed data include three red and four white marbles, so the estimated population contains 3/7 red marbles and 4/7 white marbles.
</p>
</div>
<p>By taking repeated samples from the estimated population, the variability from sample to sample can be observed.
In Figure <a href="foundations-bootstrapping.html#fig:boot2">10.2</a> the repeated bootstrap samples are obviously different both from each other and from the original population.
Recall that the bootstrap samples were taken from the same (estimated) population, and so the differences are due entirely to natural variability in the sampling procedure.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boot2"></span>
<img src="images/boot1prop2.png" alt="The same unknown large population is given with a sample of 3 red and 4 white marbles.  After the proxy population is created (infinite replicates of the sample), new resamples of size 7 can be taken from the proxy population.  Three resamples of size 7 are shown: Resample 1 has 2/7 red; Resample 2 has 4/7 red; and Resample k has 5/7 red." width="75%"><p class="caption">
Figure 10.2: Bootstrap sampling provides a measure of the sample to sample variability. Note that we are taking samples from the estimated population that was created from the observed data.
</p>
</div>
<p>By summarizing each of the bootstrap samples (here, using the sample proportion), we see, directly, the variability of the sample proportion, <span class="math inline">\(\hat{p},\)</span> from sample to sample.
The distribution of <span class="math inline">\(\hat{p}_{boot}\)</span> for the example scenario is shown in Figure <a href="foundations-bootstrapping.html#fig:boot3">10.3</a>, and the full bootstrap distribution for the medical consultant data is shown in Figure <a href="foundations-bootstrapping.html#fig:MedConsBSSim">10.6</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boot3"></span>
<img src="images/boot1prop3.png" alt="The same unknown large population with a sample of 3 red and 4 white marbles; the proxy population which is infinite with 3/7 red marbles; and the k Resamples of size 7 are shown.  From each of the resamples the bootstrapped proportion of red is calculated (shown as 2/7, 4/7, and 5/7).  Many many resamples are taken and summarized in a dotplot of the bootstrapped proportions.  The proportions range from 0/7 to 7/7 in a bell shape with the majority of bootstrapped proportions falling between 1/7 and 6/7." width="95%"><p class="caption">
Figure 10.3: The bootstrapped proportion is estimated for each bootstrap sample. The resulting bootstrap distribution (dotplot) provides a measure for how the proportions vary from sample to sample
</p>
</div>
<p>It turns out that in practice, it is very difficult for computers to work with an infinite population (with the same proportional breakdown as in the sample).
However, there is a physical and computational method which produces an equivalent bootstrap distribution of the sample proportion in a computationally efficient manner.</p>
<p>Consider the observed data to be a bag of marbles 3 of which are success (red) and 4 of which are failures (white).
By drawing the marbles out of the bag <em>with replacement</em>, we depict the exact same sampling <strong>process</strong> as was done with the infinitely large estimated population.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boot4"></span>
<img src="images/boot1prop4.png" alt="Shown is the unknown large population with a sample of 3 red and 4 white marbles. Without creating the infinitely large proxy population, resamples are taken from the original sample (by sampling with replacement from the sample). Three resamples of size 7 are shown: Resample 1 has 2/7 red; Resample 2 has 4/7 red; and Resample k has 5/7 red." width="75%"><p class="caption">
Figure 10.4: Taking repeated resamples from the sample data is the same process as creating an infinitely large estimate of the population. It is computationally more feasible to take resamples directly from the sample. Note that the resampling is now done with replacement (that is, the original sample does not ever change) so that the original sample and estimated hypothetical population are equivalent.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boot1prop"></span>
<img src="images/boot1propboth.png" alt="Top image includes the steps of (1) a large unknown population, (2) observed sample of size 7 (with 3 red and 4 white), (3) creation of an infinitely large proxy population, and (4) three resamples.  (5) Many resamples are considered with a dotplot of bootstrapped proportions.  The bottom image follows the same process without the infinitely large proxy population.  That is, in the bottom image a (1) single sample is taken from the original population and (2) the three resamples are taken directly from the observed data (using sampling with replacement).  (3) Again, many resamples are considered with a dotplot of bootstrapped proportions." width="95%"><p class="caption">
Figure 10.5: A comparison of the process of sampling from the estimate infinite population and resampling with replacement from the original sample. Note that the dotplot of bootstrapped proportions is the same because the process by which the statistics were estimated is equivalent.
</p>
</div>
<p>If we apply the bootstrap sampling process to the medical consultant example, we consider each client to be one of the marbles in the bag.
There will be 59 white marbles (no complication) and 3 red marbles (complication).
If we choose 62 marbles out of the bag (one at a time with replacement) and compute the proportion of simulated patients with complications, <span class="math inline">\(\hat{p}_{boot},\)</span> then this “bootstrap” proportion represents a single simulated proportion from the “resample from the sample” approach.</p>
<div class="guidedpractice">
<p>In a simulation of 62 patients, about how many would we expect to have had a complication? Why?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;About 4.8% of the patients (3 on average) in the simulation will have a complication, as this is what was seen in the sample.
We will, however, see a little variation from one simulation to the next.&lt;/p&gt;"><sup>84</sup></a></p>
</div>
<p>One simulation isn’t enough to get a sense of the variability from one bootstrap proportion to another bootstrap proportion, so we repeat the simulation 10,000 times using a computer.</p>
<p>Figure <a href="foundations-bootstrapping.html#fig:MedConsBSSim">10.6</a> shows the distribution from the 10,000 bootstrap simulations.
The bootstrapped proportions vary from about zero to 11.3%.
The variability in the bootstrapped proportions leads us to believe that the true probability of complication (the parameter, <span class="math inline">\(\pi\)</span>) is likely to fall somewhere between 0 and 11.3%, as these numbers capture 95% of the bootstrap resampled values.</p>
<p>The range of values for the true proportion is called a <strong>bootstrap percentile confidence interval</strong>, and we will see it again throughout the next few sections and chapters.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:MedConsBSSim"></span>
<img src="10-foundations-conf-int_files/figure-html/MedConsBSSim-1.png" alt="The original medical consultant data is bootstrapped 10,000 times. Each simulation creates a sample from the original data where the probability of a complication is \(\hat{p} = 3/62.\) The bootstrap 2.5 percentile proportion is 0 and the 97.5 percentile is 0.113. The result is: we are 95% confident that, in the population, the true probability of a complication is between 0% and 11.3%." width="90%"><p class="caption">
Figure 10.6: The original medical consultant data is bootstrapped 10,000 times. Each simulation creates a sample from the original data where the probability of a complication is <span class="math inline">\(\hat{p} = 3/62.\)</span> The bootstrap 2.5 percentile proportion is 0 and the 97.5 percentile is 0.113. The result is: we are 95% confident that, in the population, the true probability of a complication is between 0% and 11.3%.
</p>
</div>

<div class="workedexample">
<p>The original claim was that the consultant’s true rate of complication was under the national rate of 10%.
Does the interval estimate of 0 to 11.3% for the true probability of complication indicate that the surgical consultant has a lower rate of complications than the national average?
Explain.</p>
<hr>
<p>No.
Because the interval overlaps 10%, it might be that the consultant’s work is associated with a lower risk of complications, or it might be that the consultant’s work is associated with a higher risk (i.e., greater than 10%) of complications!
Additionally, as previously mentioned, because this is an observational study, even if an association can be measured, there is no evidence that the consultant’s work is the cause of the complication rate (being higher or lower).</p>
</div>
</div>
</div>
<div id="ConfidenceIntervals" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Confidence intervals<a class="anchor" aria-label="anchor" href="#ConfidenceIntervals"><i class="fas fa-link"></i></a>
</h2>
<p>A point estimate provides a single plausible value for a parameter. However, a point estimate is rarely perfect—usually there is some error in the estimate. In addition to supplying a point estimate of a parameter, a next logical step would be to provide a plausible <em>range of values</em> for the parameter.</p>
<div id="plausible-range-of-values-for-the-population-parameter" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> Plausible range of values for the population parameter<a class="anchor" aria-label="anchor" href="#plausible-range-of-values-for-the-population-parameter"><i class="fas fa-link"></i></a>
</h3>
<p>A plausible range of values for the population parameter is called a <strong>confidence interval</strong>. Using only a single point estimate is like fishing in a murky lake with a spear, and using a confidence interval is like fishing with a net. We can throw a spear where we saw a fish, but we will probably miss. On the other hand, if we toss a net in that area, we have a good chance of catching the fish.</p>
<p>If we report a point estimate, we probably will not hit the exact population parameter. On the other hand, if we report a range of plausible values—a confidence interval—we have a good shot at capturing the parameter.</p>
<p>This reasoning also explains why we can never prove a null hypothesis. Sample statistics will vary from sample to sample. While we can quantify this uncertainty (e.g., we are 95% sure the statistic will fall within 0.15 of the parameter), we can never be certain that the parameter is an exact value.
For example, suppose you want to test whether a coin is a fair coin, i.e., <span class="math inline">\(H_0: \pi = 0.50\)</span> versus <span class="math inline">\(H_0: \pi \neq 0.50\)</span>, so you toss the coin 10 times to collect data. In those 10 tosses, 6 land on heads and 4 land on tails, resulting in a p-value of 0.754<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;You will get more practice calculating p-values such as these in Chapter &lt;a href="inference-one-prop.html#inference-one-prop"&gt;14&lt;/a&gt;.&lt;/p&gt;'><sup>85</sup></a>. We don’t have enough evidence to show that the coin is biased, but surely we wouldn’t say we just proved the coin is fair!</p>
<div class="guidedpractice">
<p>If we want to be very certain we capture the population parameter, should we use a wider interval (e.g., 99%) or a smaller interval (e.g., 80%)?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;If we want to be more certain we will capture the fish, we might use a wider net.
Likewise, we use a wider confidence interval if we want to be more certain that we capture the parameter.&lt;/p&gt;"><sup>86</sup></a></p>
</div>
</div>
<div id="bootstrap-confidence-interval" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> Bootstrap confidence interval<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>As we saw above, a <strong>bootstrap sample</strong> is a sample of the original sample.
In the case of the medical complications data, we proceed as follows:</p>
<ul>
<li>Randomly sample one observation from the 62 patients (replace the marble back into the bag so as to keep the population constant).</li>
<li>Randomly sample a second observation from the 62 patients. Because we sample with replacement (i.e., we do not actually remove the marbles from the bag), there is a 1-in-62 chance that the second observation will be the same one sampled in the first step!</li>
<li>Keep going one sampled observation at a time …</li>
<li>Randomly sample the 62nd observation from the 62 patients.</li>
</ul>
<p>Bootstrap sampling is often called <strong>sampling with replacement</strong>.</p>
<p>A bootstrap sample behaves similarly to how an actual sample from a population would behave, and we compute the point estimate of interest (here, compute <span class="math inline">\(\hat{p}_{boot}\)</span>).</p>
<p>Due to theory that is beyond this text, we know that the bootstrap proportions <span class="math inline">\(\hat{p}_{boot}\)</span> vary around <span class="math inline">\(\hat{p}\)</span> in a similar way to how different sample proportions (i.e., values of <span class="math inline">\(\hat{p}\)</span>) vary around the true parameter <span class="math inline">\(\pi.\)</span></p>
<p>Therefore, an interval estimate for <span class="math inline">\(\pi\)</span> can be produced using the <span class="math inline">\(\hat{p}_{boot}\)</span> values themselves.</p>
<div class="onebox">
<p><strong>95% Bootstrap percentile confidence interval for a parameter</strong> <span class="math inline">\(\pi.\)</span></p>
<p>The 95% bootstrap confidence interval for the parameter <span class="math inline">\(\pi\)</span> can be obtained directly using the ordered <span class="math inline">\(\hat{p}_{boot}\)</span> values.</p>
<p>Consider the sorted <span class="math inline">\(\hat{p}_{boot}\)</span> values.
Call the 2.5% bootstrapped proportion value “lower”, and call the 97.5% bootstrapped proportion value “upper”.</p>
<p>The 95% confidence interval is given by: (lower, upper)</p>
</div>
<!-- ::: {.underconstruction} -->
<!-- Need to update these two section references once they're ready: -->
<!-- ::: -->
<p>In Section <a href="inference-one-prop.html#one-prop-null-boot">14.1</a> we will discuss different percentages for the confidence level (e.g., 90% confidence interval or 99% confidence interval).</p>
<p>Section <a href="inference-one-prop.html#one-prop-null-boot">14.1</a> also provides a longer discussion on what “95% confidence” actually means.</p>
</div>
</div>
<div id="case-study-med-consult-test" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Case study: Medical consultant revisited<a class="anchor" aria-label="anchor" href="#case-study-med-consult-test"><i class="fas fa-link"></i></a>
</h2>
<!-- ::: {.underconstruction} -->
<!-- Add to the medical consultant example here to demonstrate a shifted bootstrap distribution in order to simulate a null distribution. -->
<!-- ::: -->
</div>
<div id="chp10-review" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Chapter review<a class="anchor" aria-label="anchor" href="#chp10-review"><i class="fas fa-link"></i></a>
</h2>
<!-- ### Summary {-} -->
<!-- ::: {.underconstruction} -->
<!-- TODO -->
<!-- ::: -->
<div id="terms-8" class="section level3 unnumbered">
<h3>Terms<a class="anchor" aria-label="anchor" href="#terms-8"><i class="fas fa-link"></i></a>
</h3>
<p>We introduced the following terms in the chapter. If you’re not sure what some of these terms mean, we recommend you go back in the text and review their definitions. We are purposefully presenting them in alphabetical order, instead of in order of appearance, so they will be a little more challenging to locate. However you should be able to easily spot them as <strong>bolded text</strong>.</p>
<div class="inline-table"><table class="table table-striped table-condensed" style="margin-left: auto; margin-right: auto;"><tbody><tr>
<td style="text-align:left;">
bootstrapping
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr></tbody></table></div>
<!-- ### Key ideas {-} --><!-- ::: {.underconstruction} --><!-- TODO --><!-- ::: -->
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="foundations-randomization.html"><span class="header-section-number">9</span> Hypothesis testing with randomization</a></div>
<div class="next"><a href="foundations-mathematical.html"><span class="header-section-number">11</span> Inference with mathematical models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#foundations-bootstrapping"><span class="header-section-number">10</span> Confidence intervals with bootstrapping</a></li>
<li>
<a class="nav-link" href="#case-study-med-consult"><span class="header-section-number">10.1</span> Case study: Medical consultant</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#observed-data-2"><span class="header-section-number">10.1.1</span> Observed data</a></li>
<li><a class="nav-link" href="#variability-of-the-statistic-1"><span class="header-section-number">10.1.2</span> Variability of the statistic</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ConfidenceIntervals"><span class="header-section-number">10.2</span> Confidence intervals</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plausible-range-of-values-for-the-population-parameter"><span class="header-section-number">10.2.1</span> Plausible range of values for the population parameter</a></li>
<li><a class="nav-link" href="#bootstrap-confidence-interval"><span class="header-section-number">10.2.2</span> Bootstrap confidence interval</a></li>
</ul>
</li>
<li><a class="nav-link" href="#case-study-med-consult-test"><span class="header-section-number">10.3</span> Case study: Medical consultant revisited</a></li>
<li>
<a class="nav-link" href="#chp10-review"><span class="header-section-number">10.4</span> Chapter review</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#terms-8">Terms</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/MTstateIntroStats/IntroStatTextbook/blob/master/10-foundations-conf-int.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/MTstateIntroStats/IntroStatTextbook/edit/master/10-foundations-conf-int.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Montana State Introductory Statistics with R</strong>" was written by Nicole Carnegie, Stacey Hancock, Elijah Meyer, Jade Schmidt, Melinda Yager. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
