<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 16 Applications: Infer categorical | Montana State Introductory Statistics with R</title>
<meta name="author" content="Stacey Hancock, Nicole Carnegie, Elijah Meyer, Jade Schmidt, Melinda Yager">
<meta name="description" content="In this chapter, we will explore how to conduct statistical inference for categorical variables using the catstats package in RStudio. Review the Preliminaries Chapter for instructions for...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 16 Applications: Infer categorical | Montana State Introductory Statistics with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mtstateintrostats.github.io/IntroStatTextbook/inference-categ-applications.html">
<meta property="og:description" content="In this chapter, we will explore how to conduct statistical inference for categorical variables using the catstats package in RStudio. Review the Preliminaries Chapter for instructions for...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 16 Applications: Infer categorical | Montana State Introductory Statistics with R">
<meta name="twitter:description" content="In this chapter, we will explore how to conduct statistical inference for categorical variables using the catstats package in RStudio. Review the Preliminaries Chapter for instructions for...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Montana State Introductory Statistics with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="authors.html">Authors</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="rstudio.html">Preliminaries: Getting started in RStudio</a></li>
<li class="book-part">Introduction to data</li>
<li><a class="" href="data-hello.html"><span class="header-section-number">1</span> Hello data</a></li>
<li><a class="" href="data-design.html"><span class="header-section-number">2</span> Study design</a></li>
<li><a class="" href="data-applications.html"><span class="header-section-number">3</span> Applications: Data</a></li>
<li class="book-part">Exploratory data analysis</li>
<li><a class="" href="explore-categorical.html"><span class="header-section-number">4</span> Exploring categorical data</a></li>
<li><a class="" href="explore-numerical.html"><span class="header-section-number">5</span> Exploring quantitative data</a></li>
<li><a class="" href="explore-regression.html"><span class="header-section-number">6</span> Correlation and regression</a></li>
<li><a class="" href="explore-mult-reg.html"><span class="header-section-number">7</span> Multivariable models</a></li>
<li><a class="" href="explore-applications.html"><span class="header-section-number">8</span> Applications: Explore</a></li>
<li class="book-part">Foundations of inference</li>
<li><a class="" href="foundations-randomization.html"><span class="header-section-number">9</span> Hypothesis testing with randomization</a></li>
<li><a class="" href="foundations-bootstrapping.html"><span class="header-section-number">10</span> Confidence intervals with bootstrapping</a></li>
<li><a class="" href="foundations-mathematical.html"><span class="header-section-number">11</span> Inference with mathematical models</a></li>
<li><a class="" href="foundations-errors.html"><span class="header-section-number">12</span> Errors, power, and practical importance</a></li>
<li><a class="" href="foundations-applications.html"><span class="header-section-number">13</span> Applications: Foundations</a></li>
<li class="book-part">Inference for categorical data</li>
<li><a class="" href="inference-one-prop.html"><span class="header-section-number">14</span> Inference for a single proportion</a></li>
<li><a class="" href="inference-two-props.html"><span class="header-section-number">15</span> Inference for comparing two proportions</a></li>
<li><a class="active" href="inference-categ-applications.html"><span class="header-section-number">16</span> Applications: Infer categorical</a></li>
<li class="book-part">Inference for quantitative data</li>
<li><a class="" href="inference-one-mean.html"><span class="header-section-number">17</span> Inference for a single mean</a></li>
<li><a class="" href="inference-paired-means.html"><span class="header-section-number">18</span> Inference for comparing paired means</a></li>
<li><a class="" href="inference-two-means.html"><span class="header-section-number">19</span> Inference for comparing two independent means</a></li>
<li><a class="" href="inference-num-applications.html"><span class="header-section-number">20</span> Applications: Infer quantitative</a></li>
<li class="book-part">Inference for regression</li>
<li><a class="" href="inference-reg.html"><span class="header-section-number">21</span> Inference for correlation and slope</a></li>
<li><a class="" href="inference-reg-applications.html"><span class="header-section-number">22</span> Applications: Infer regression</a></li>
<li class="book-part">Probability</li>
<li><a class="" href="probability.html"><span class="header-section-number">23</span> Probability with tables</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/MTstateIntroStats/IntroStatTextbook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="inference-categ-applications" class="section level1" number="16">
<h1>
<span class="header-section-number">16</span> Applications: Infer categorical<a class="anchor" aria-label="anchor" href="#inference-categ-applications"><i class="fas fa-link"></i></a>
</h1>
<div class="chapterintro">
<p>In this chapter, we will explore how to conduct statistical inference for categorical variables using the <code>catstats</code> package in RStudio. Review the <a href="rstudio">Preliminaries</a> Chapter for instructions for installing <code>catstats</code>.
We encourage you to work through the code in this chapter in
your own RStudio session.</p>
</div>
<p>Much of the R code we use below is from the <code>tidyverse</code> R package. Load this package and the <code>catstats</code> package prior to running the code in this chapter.</p>
<div id="making-tables-from-raw-data" class="section level2 unnumbered">
<h2>Making tables from raw data<a class="anchor" aria-label="anchor" href="#making-tables-from-raw-data"><i class="fas fa-link"></i></a>
</h2>
<p>If you are collecting your own data, then your analysis starts with the raw data frame, with one observational unit per row and one variable per column. In this case, you first need to find counts (frequencies) of observations in each category prior to inference. We can use the <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> function in R on the raw data to create a contingency table of the counts for each categorical variable.</p>
<p>In the one-proportion case, suppose we have a data frame called <code>loans</code> with a variable <code>regulate</code> that contains the Yes/No response of the 826 payday loan borrowers from Section <a href="inference-one-prop.html#payday-lenders">14.3.2</a> regarding their support for a regulation to require lenders to pull their credit report and evaluate their debt payments. Run the following line of code to create this data set in RStudio.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>regulate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="fl">422</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="fl">404</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can obtain counts of borrowers for each response using the <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> function in R:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">loans</span><span class="op">$</span><span class="va">regulate</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;  No Yes 
#&gt; 404 422</code></pre>
<p>In the R code above, <code>loans</code> is the name of the data set in R, and <code>regulate</code> is the name of the variable. The <code>$</code> tells R to select the <code>regulate</code> variable from the <code>loans</code> data set. We could have also used the pipe command to generate the table:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">regulate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; regulate
#&gt;  No Yes 
#&gt; 404 422</code></pre>
<p>We can also use <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> to compute the proportions in each group:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#If we know the number of observations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">loans</span><span class="op">$</span><span class="va">regulate</span><span class="op">)</span><span class="op">/</span><span class="fl">826</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;    No   Yes 
#&gt; 0.489 0.511</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#If we don't know the number of observations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">loans</span><span class="op">$</span><span class="va">regulate</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">loans</span><span class="op">$</span><span class="va">regulate</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;    No   Yes 
#&gt; 0.489 0.511</code></pre>
<p>For comparisons of two proportions, we get a two-way table. Consider the case study of the effect of blood thinners on survival after receiving CPR from Section <a href="inference-two-props.html#cpr">15.1.1</a>. Data from this study are stored in a data frame called <code>cpr</code>, with variables <code>survival</code> – giving each patient’s outcome decision – and <code>group</code> – indicating whether they were in the treatment (blood thinner) or control (no blood thinner) group. Run the following lines of code to create this data set in RStudio.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survival</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Survived"</span>, <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Died"</span>, <span class="fl">65</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span>, <span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">14</span>, <span class="fl">39</span>, <span class="fl">26</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">survival</span>, <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> functions can help us see what variables are in our data set and the values they take on:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; Rows: 90
#&gt; Columns: 2
#&gt; $ survival &lt;fct&gt; Survived, Survived, Survived, Survived, Survived, Survived, S…
#&gt; $ group    &lt;fct&gt; control, control, control, control, control, control, control…</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;      survival        group   
#&gt;  Died    :65   control  :50  
#&gt;  Survived:25   treatment:40</code></pre>
<p>To obtain the two-way table of the choices by group, we again use the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function in R. The key thing to remember here is to put the response variable (outcome) as the first argument and the explanatory variable (grouping) as the second. In our example, <code>survival</code> is the response variable, and <code>group</code> is the explanatory variable.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            control treatment
#&gt;   Died          39        26
#&gt;   Survived      11        14</code></pre>
<p>This will set up the table to be useful for making segmented bar plots and using column percentages to compute test statistics. In order to do either of these things, we need to store the table in an R object so we can manipulate it further:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>To get column percentages, we use the <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> function:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">data_tbl</span>,  <span class="co">#Feed in your two-way table</span></span>
<span>           margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co">#Tell it to compute percentages for columns</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            control treatment
#&gt;   Died        0.78      0.65
#&gt;   Survived    0.22      0.35</code></pre>
<!-- #### Making tables from counts {-} -->
<!-- If you don't have access to the raw data, and only have access to the two-way table itself, you can create this table in R with the `as.table` function. -->
<div id="simulation-based-inference-for-one-proportion" class="section level3 unnumbered">
<h3>Simulation-based inference for one proportion<a class="anchor" aria-label="anchor" href="#simulation-based-inference-for-one-proportion"><i class="fas fa-link"></i></a>
</h3>
<p>For simulation-based inference, we will use functions included in the <code>catstats</code> package, created for MSU Statistics courses. See the <a href="#stat-computing">Statistical computing</a> section at the beginning of this textbook for instructions on how to install <code>catstats</code> if you haven’t already. If the package is installed, you can load it into an R session to make the functions available using the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">catstats</span><span class="op">)</span></span></code></pre></div>
<p>Once you have loaded the package, you will be able to use the functions for simulation-based inference. For one-proportion inference, this is the <code><a href="https://rdrr.io/pkg/catstats/man/one_proportion_test.html">one_proportion_test()</a></code> function and <code><a href="https://rdrr.io/pkg/catstats/man/one_proportion_bootstrap_CI.html">one_proportion_bootstrap_CI()</a></code> function. Returning to the payday loan regulation example, we can obtain a simulation distribution and p-value using the following function call:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/catstats/man/one_proportion_test.html">one_proportion_test</a></span><span class="op">(</span></span>
<span>  probability_success <span class="op">=</span> <span class="fl">0.5</span>, <span class="co">#null hypothesis probability of success</span></span>
<span>  sample_size <span class="op">=</span> <span class="fl">826</span>,  <span class="co">#number of observations</span></span>
<span>  number_repetitions <span class="op">=</span> <span class="fl">1000</span>,  <span class="co">#number of simulations to create</span></span>
<span>  as_extreme_as <span class="op">=</span> <span class="fl">0.51</span>,  <span class="co">#observed statistic</span></span>
<span>  direction <span class="op">=</span> <span class="st">"greater"</span>,  <span class="co">#alternative hypothesis direction</span></span>
<span>  summary_measure <span class="op">=</span> <span class="st">"proportion"</span>  <span class="co">#Report number or proportion of successes?</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="16-categorical-applications_files/figure-html/onePropSimInf-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="importantbox">
<p>Note that the observed statistic (<code>as_extreme_as</code>) and the <code>summary_measure</code> input need to match; since we put in the observed statistic as a proportion, we need to tell the function to report the proportion of successes. If they don’t match, you will almost certainly get a p-value of 0 or 1 – this can happen when there is very strong evidence against the null, but it is always good to check your function inputs when you get an extreme outcome to make sure that is what you should be seeing.</p>
</div>
<p>In the resulting graph, we see the null distribution of simulated proportions, with those greater than the observed value of 0.51 highlighted in blue. In the figure caption, we see that 308 of our 1000 simulations resulted in a proportion of successes at least as large as the observed value, yielding an approximate p-value of 0.308.</p>
<p>To find a confidence interval for the true proportion of payday loan borrowers who support the regulation, we use the <code><a href="https://rdrr.io/pkg/catstats/man/one_proportion_bootstrap_CI.html">one_proportion_bootstrap_CI()</a></code> function:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/catstats/man/one_proportion_bootstrap_CI.html">one_proportion_bootstrap_CI</a></span><span class="op">(</span></span>
<span>  sample_size <span class="op">=</span> <span class="fl">826</span>,  <span class="co">#Number of observations</span></span>
<span>  number_successes <span class="op">=</span> <span class="fl">422</span>,  <span class="co">#Number of observed successes </span></span>
<span>  number_repetitions <span class="op">=</span> <span class="fl">1000</span>,  <span class="co">#Number of bootstrap draws</span></span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>  <span class="co">#Confidence level, as a proportion</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="16-categorical-applications_files/figure-html/onePropBootCI-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>This produces a plot of the bootstrapped proportions with the upper and lower bounds of the confidence interval marked, and gives the interval itself in the figure caption: in this case, we are 95% confident that the true proportion of payday loan borrowers who support the proposed regulation is between 0.479 and 0.546.</p>
</div>
<div id="simulation-based-inference-for-difference-in-two-proportions" class="section level3 unnumbered">
<h3>Simulation-based inference for difference in two proportions<a class="anchor" aria-label="anchor" href="#simulation-based-inference-for-difference-in-two-proportions"><i class="fas fa-link"></i></a>
</h3>
<p>For inference about the difference between two proportions, we use the <code><a href="https://rdrr.io/pkg/catstats/man/two_proportion_test.html">two_proportion_test()</a></code> and <code><a href="https://rdrr.io/pkg/catstats/man/two_proportion_bootstrap_CI.html">two_proportion_bootstrap_CI()</a></code> functions. These functions assume you have a data frame with the group and outcome included as variables. Using the CPR and blood thinner study, a call to <code><a href="https://rdrr.io/pkg/catstats/man/two_proportion_test.html">two_proportion_test()</a></code> would look like this:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/catstats/man/two_proportion_test.html">two_proportion_test</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">survival</span> <span class="op">~</span> <span class="va">group</span>,  <span class="co">#Always do response ~ explanatory</span></span>
<span>  data <span class="op">=</span> <span class="va">cpr</span>,   <span class="co">#Name of the data set</span></span>
<span>  first_in_subtraction <span class="op">=</span> <span class="st">"treatment"</span>, <span class="co">#Value of the explanatory variable that is first in order of subtraction</span></span>
<span>  response_value_numerator <span class="op">=</span> <span class="st">"Survived"</span>,  <span class="co">#Value of response that is a "success"</span></span>
<span>  number_repetitions <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  as_extreme_as <span class="op">=</span> <span class="fl">0.13</span>,  <span class="co">#Observed statistic</span></span>
<span>  direction <span class="op">=</span> <span class="st">"two-sided"</span>  <span class="co">#Direction of the alternative hypothesis</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="16-categorical-applications_files/figure-html/twoPropSimInf-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The results give a segmented bar plot of the data — you can check that your formula is correct by making sure the explanatory variable is on the <span class="math inline">\(x\)</span>-axis and the response variable is on the <span class="math inline">\(y\)</span>-axis. Look to the top right of the bar plot to check that you have the correct order of subtraction. Next to the bar plot, we have the null distribution of simulated differences in proportions, with the observed statistic marked with a vertical line and all values as or more extreme than the observed statistic colored red. The figure caption gives the approximate p-value: in this case 181/1000 = 0.181.</p>
<div class="importantbox">
<p>There are a couple of things to note when using the <code>two_proportion_test</code> function:</p>
<ul>
<li>You need to identify which variable is your outcome and which your group using the <code>formula</code> argument.</li>
<li>Specify order of subtraction using <code>first_in_subtraction</code> by putting in EXACTLY the category of the explanatory variable that you want to be first, in quotes — must match capitalization, spaces, etc. for text values!</li>
<li>Specify what is a success using <code>response_value_numerator</code> but putting in EXACTLY the category of the response that you consider a success, in quotes. Again, capitalization, spaces, etc. matter here!</li>
</ul>
</div>
<p>To produce a confidence interval for the true difference in the proportion of patients that survive after receiving CPR, we use <code><a href="https://rdrr.io/pkg/catstats/man/two_proportion_bootstrap_CI.html">two_proportion_bootstrap_CI()</a></code>, which uses most of the same arguments as the <code><a href="https://rdrr.io/pkg/catstats/man/two_proportion_test.html">two_proportion_test()</a></code> function:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/catstats/man/two_proportion_bootstrap_CI.html">two_proportion_bootstrap_CI</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">survival</span> <span class="op">~</span> <span class="va">group</span>,  <span class="co">#Always do response ~ explanatory</span></span>
<span>  data <span class="op">=</span> <span class="va">cpr</span>,   <span class="co">#Name of the data set</span></span>
<span>  first_in_subtraction <span class="op">=</span> <span class="st">"treatment"</span>, <span class="co">#Value of the explanatory variable that is first in order of subtraction</span></span>
<span>  response_value_numerator <span class="op">=</span> <span class="st">"Survived"</span>,  <span class="co">#Value of response that is a "success"</span></span>
<span>  number_repetitions <span class="op">=</span> <span class="fl">1000</span>, <span class="co">#Number of bootstrap samples</span></span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.99</span>  <span class="co">#Confidence level, as a proportion</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="16-categorical-applications_files/figure-html/twoPropBootCI-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>This produces the distribution of bootstrapped statistics with the bounds of the confidence interval marked, and the value included in the caption. Here, we are 99% confident that the true proportion of patients who survive after receiving CPR is between 0.1 lower and 0.35 higher when patients are given blood thinners compared to when they are not.</p>
</div>
<div id="theory-based-inference-for-one-proportion" class="section level3 unnumbered">
<h3>Theory-based inference for one proportion<a class="anchor" aria-label="anchor" href="#theory-based-inference-for-one-proportion"><i class="fas fa-link"></i></a>
</h3>
<p>For theory-based inference, we can use the built-in R function <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;By “built-in”, we mean that it is in the R “base” library, so no packages need to be loaded.&lt;/p&gt;"><sup>139</sup></a> For a one-proportion test, we need to tell it the number of successes, the number of trials (sample size), and the null value. Using the payday loan regulation example, a call would look like this:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">422</span>,  <span class="co">#Number of successes</span></span>
<span>          n <span class="op">=</span> <span class="fl">826</span>, <span class="co">#Number of trials</span></span>
<span>          p <span class="op">=</span> <span class="fl">.5</span>, <span class="co">#Null hypothesis value</span></span>
<span>          alternative <span class="op">=</span> <span class="st">"greater"</span>, <span class="co">#Direction of alternative,</span></span>
<span>          conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="co">#Confidence level as a proportion</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;  1-sample proportions test with continuity correction
#&gt; 
#&gt; data:  422 out of 826
#&gt; X-squared = 0.3, df = 1, p-value = 0.3
#&gt; alternative hypothesis: true p is greater than 0.5
#&gt; 95 percent confidence interval:
#&gt;  0.482 1.000
#&gt; sample estimates:
#&gt;     p 
#&gt; 0.511</code></pre>
<p>In this output, we can get our observed statistic <span class="math inline">\(\hat{p} = 0.51\)</span> in the last line of the output (under <code>sample estimates: p</code>), and the p-value of 0.2656 from the second line of the output. You should always check that the null value and the alternative hypothesis in the output matches the problem.</p>
<div class="importantbox">
<p>You might have noticed that the test statistic reported in the output is <code>X-squared</code> rather than our Z-statistic. This test statistic is equal to our Z-statistic squared, and the p-value is found from what is called a <span class="math inline">\(\chi^2\)</span> distribution (pronounced “kai squared”). To get the Z-statistic from the <code>X-squared</code> statistic, take the positive square root if <span class="math inline">\(\hat{p} &gt; \pi_0\)</span>, and the negative square root if <span class="math inline">\(\hat{p} &lt; \pi_0\)</span>.</p>
</div>
<div class="guidedpractice">
<p>Use the R output to find the value of the Z-statistic.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Since our sample proportion &lt;span class="math inline"&gt;\(\hat{p} = 0.511\)&lt;/span&gt; is larger than the null value &lt;span class="math inline"&gt;\(\pi_0 = 0.5\)&lt;/span&gt;, we know our Z-statistic will be positive. Thus, &lt;span class="math inline"&gt;\(Z = +\sqrt{0.34988} = 0.592\)&lt;/span&gt;. Check these values using the formula for the Z-statistic presented in Section &lt;a href="inference-one-prop.html#theory-prop"&gt;14.3&lt;/a&gt;.&lt;/p&gt;'><sup>140</sup></a></p>
</div>
<p>The <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function will also produce the theory-based confidence interval, but to get the correct confidence interval, <strong>we need to run the function with a two-sided alternative</strong>:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;If you run &lt;code&gt;prop.test&lt;/code&gt; with a one-sided alternative (&lt;code&gt;"greater"&lt;/code&gt; or &lt;code&gt;"less"&lt;/code&gt;), then R will report what is called a “one-sided confidence interval”, where one of the endpoints is either 0 (for a “less” alternative) or 1 (for a “greater” alternative). This is equivalent to only producing an upper bound or a lower bound, respectively, for the parameter of interest.&lt;/p&gt;'><sup>141</sup></a></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">422</span>,  <span class="co">#Number of successes</span></span>
<span>          n <span class="op">=</span> <span class="fl">826</span>, <span class="co">#Number of trials</span></span>
<span>          p <span class="op">=</span> <span class="fl">.5</span>, <span class="co">#Null hypothesis value</span></span>
<span>          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, <span class="co">#Direction of alternative,</span></span>
<span>          conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="co">#Confidence level as a proportion</span></span>
<span>          correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#We will not use  a continuity correction</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;  1-sample proportions test without continuity correction
#&gt; 
#&gt; data:  422 out of 826
#&gt; X-squared = 0.4, df = 1, p-value = 0.5
#&gt; alternative hypothesis: true p is not equal to 0.5
#&gt; 95 percent confidence interval:
#&gt;  0.477 0.545
#&gt; sample estimates:
#&gt;     p 
#&gt; 0.511</code></pre>
<p>From this output, we obtain a 95% confidence interval for the true proportion of payday loan borrowers who support the new regulation of (0.477, 0.545).</p>
</div>
<div id="theory-based-inference-for-a-difference-in-two-proportions" class="section level3 unnumbered">
<h3>Theory-based inference for a difference in two proportions<a class="anchor" aria-label="anchor" href="#theory-based-inference-for-a-difference-in-two-proportions"><i class="fas fa-link"></i></a>
</h3>
<p>When comparing two proportions, we use the same function, <code>prop.test</code>, but the inputs are now “vectors” rather than “scalars”. As an example, we will again use the CPR and blood thinner study from Section <a href="foundations-errors.html#two-sided-tests">12.3</a>.</p>
<p>First, use the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function to determine the number of successes and the sample size in each category of the explanatory variable:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            control treatment
#&gt;   Died          39        26
#&gt;   Survived      11        14</code></pre>
<p>From these results (and the example in Section <a href="foundations-errors.html#two-sided-tests">12.3</a>), we see that the Treatment group (call this group 1) had 14 survive (successes) out of 40 patients (sample size); the Control group (call this group 2) had 11 survive out of 50 patients. These counts are input into the <code>prop.test</code> function as follows:</p>
<ul>
<li>
<code>x</code> = vector of number of successes = <code>c(num successes in group 1, num successes in group 2)</code>
</li>
<li>
<code>n</code> = vector of sample sizes = <code>c(sample size for group 1, sample size for group 2)</code>
</li>
</ul>
<p>R creates a vector using the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> (or “combine”) function. R will take the order of subtraction to be group 1 <span class="math inline">\(-\)</span> group 2.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">11</span><span class="op">)</span>, <span class="co">#Number successes in group 1 and group 2</span></span>
<span>          n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>, <span class="co">#Sample size of group 1 and group 2</span></span>
<span>          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, <span class="co">#Match sign of alternative</span></span>
<span>                                     <span class="co">#for order of subtraction </span></span>
<span>                                     <span class="co">#group 1 - group 2</span></span>
<span>          conf.level <span class="op">=</span> <span class="fl">0.99</span>, <span class="co">#Confidence level as a proportion</span></span>
<span>          correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co">#No continuity correction</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;  2-sample test for equality of proportions without continuity correction
#&gt; 
#&gt; data:  c out of c14 out of 4011 out of 50
#&gt; X-squared = 2, df = 1, p-value = 0.2
#&gt; alternative hypothesis: two.sided
#&gt; 99 percent confidence interval:
#&gt;  -0.116  0.376
#&gt; sample estimates:
#&gt; prop 1 prop 2 
#&gt;   0.35   0.22</code></pre>
<p>The observed proportions in each group are given under <code>sample estimates: prop 1 prop 2</code>. R will always take (prop 1 - prop 2) as the order of subtraction. If the observed proportions don’t match your calculations of the proportion of successes or are in the wrong order of subtraction, go back and check your inputs to the <code>x</code> and <code>n</code> arguments.</p>
<p>Here, we obtain a p-value of 0.1712 — little to no evidence against the null hypothesis of no difference between the two groups.</p>
<p>Since we used a two-sided alternative in <code>prop.test</code>c, this call also produces the correct confidence interval. Our 99% confidence interval for the true difference in the proportion of patients who survive is <span class="math inline">\((-0.116, 0.376)\)</span>. We are 99% confident that the true proportion of patients who survive under the treatment is between 0.116 lower and 0.376 higher than the true proportion of patients who survive under the control condition. The fact that this confidence interval contains zero also shows us that we have little to no evidence of a difference in probability of survival between the two groups.</p>
<p>The function <code>prop.test</code> will also take a table created by the <code>table</code> function. First, we need to create our table of counts from the raw data, which then becomes our primary input to <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>. There is one important step to take before creating our table: R will always put the categories of a categorical variable in alphabetical order when building tables, unless told otherwise.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">data_tbl</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            control treatment
#&gt;   Died          39        26
#&gt;   Survived      11        14</code></pre>
<p>However, <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> will assume that the top row is a “success” and the order of subtraction is (column 1 - column 2). Without re-arranging our table, we would get the wrong order of subtraction and/or the wrong proportion of successes in each group. To fix this, we need to <code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code> our inputs to tell R to put them in the order we want:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Switch order of subtraction:</span></span>
<span><span class="va">cpr</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">group</span>, ref <span class="op">=</span> <span class="st">"treatment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            treatment control
#&gt;   Died            26      39
#&gt;   Survived        14      11</code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Switch "success":</span></span>
<span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, ref <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt;           
#&gt;            treatment control
#&gt;   Survived        14      11
#&gt;   Died            26      39</code></pre>
<p>After re-arranging our table, we can use this <code>data_tbl</code> as the first argument in the <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cpr</span><span class="op">$</span><span class="va">survival</span>, <span class="va">cpr</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_tbl</span>,</span>
<span>          alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>          conf.level <span class="op">=</span> <span class="fl">0.99</span>, <span class="co">#Confidence level as a proportion</span></span>
<span>          correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co">#No continuity correction</span></span></code></pre></div>
<pre><code>#&gt; 
#&gt;  2-sample test for equality of proportions without continuity correction
#&gt; 
#&gt; data:  data_tbl
#&gt; X-squared = 2, df = 1, p-value = 0.2
#&gt; alternative hypothesis: two.sided
#&gt; 99 percent confidence interval:
#&gt;  -0.14  0.46
#&gt; sample estimates:
#&gt; prop 1 prop 2 
#&gt;   0.56   0.40</code></pre>
</div>
</div>
<div id="catstats-function-summary" class="section level2" number="16.1">
<h2>
<span class="header-section-number">16.1</span> <code>catstats</code> function summary<a class="anchor" aria-label="anchor" href="#catstats-function-summary"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous section, you were introduced to four new R functions in the <code>catstats</code> library. Here we provide a summary of these functions. You can also access the help files for these functions using the <code>?</code> command. For example, type <code><a href="https://rdrr.io/pkg/catstats/man/one_proportion_test.html">?one_proportion_test</a></code> into your R console to bring up the help file for the <code>one_proportion_test</code> function. <br></p>
<ol style="list-style-type: decimal">
<li>
<p><code>one_proportion_test</code>: Simulation-based hypothesis test for a single proportion.</p>
<ul>
<li>
<code>probability_success</code> = null value</li>
<li>
<code>sample_size</code> = sample size (<span class="math inline">\(n\)</span>)</li>
<li>
<code>summary_measure</code> = one of <code>"number"</code> or <code>"proportion"</code> (quotations are important here!) to simulate either sample counts or sample proportions (needs to match the form of the observed statistic)<br>
</li>
<li>
<code>direction</code> = one of <code>"greater"</code>, <code>"less"</code>, or <code>"two-sided"</code> (quotations are important here!) to match the sign in <span class="math inline">\(H_A\)</span>
</li>
<li>
<code>as_extreme_as</code> = value of observed statistic</li>
<li>
<code>number_repetitions</code> = number of simulated samples to generate (should be at least 1000!) <br>
</li>
</ul>
</li>
<li>
<p><code>one_proportion_bootstrap_CI</code>: Bootstrap confidence interval for one proportion.</p>
<ul>
<li>
<code>sample_size</code> = sample size (<span class="math inline">\(n\)</span>)</li>
<li>
<code>number_successes</code> = number of successes (note that <span class="math inline">\(\hat{p}\)</span> = <code>number_successes</code>/<code>sample_size</code>)</li>
<li>
<code>confidence_level</code> = confidence level as a decimal (e.g., 0.90, 0.95, etc)</li>
<li>
<code>number_repetitions</code> = number of simulated samples to generate (should be at least 1000!) <br>
</li>
</ul>
</li>
<li>
<p><code>two_proportion_test</code>: Simulation-based hypothesis test for a single proportion.</p>
<ul>
<li>
<code>formula</code> = <code>y ~ x</code> where <code>y</code> is the name of the response variable in the data set and <code>x</code> is the name of the explanatory variable</li>
<li>
<code>data</code> = name of data set</li>
<li>
<code>first_in_subtraction</code> = category of the explanatory variable which should be first in subtraction, written in quotations</li>
<li>
<code>response_value_numerator</code> = category of the response variable which we are counting as a “success”, written in quotations</li>
<li>
<code>direction</code> = one of <code>"greater"</code>, <code>"less"</code>, or <code>"two-sided"</code> (quotations are important here!) to match the sign in <span class="math inline">\(H_A\)</span>
</li>
<li>
<code>as_extreme_as</code> = value of observed difference in proportions</li>
<li>
<code>number_repetitions</code> = number of simulated samples to generate (should be at least 1000!) <br>
</li>
</ul>
</li>
<li>
<p><code>two_proportion_bootstrap_CI</code>: Bootstrap confidence interval for one proportion.</p>
<ul>
<li>
<code>formula</code> = <code>y ~ x</code> where <code>y</code> is the name of the response variable in the data set and <code>x</code> is the name of the explanatory variable</li>
<li>
<code>data</code> = name of data set</li>
<li>
<code>first_in_subtraction</code> = category of the explanatory variable which should be first in subtraction, written in quotations</li>
<li>
<code>response_value_numerator</code> = category of the response variable which we are counting as a “success”, written in quotations</li>
<li>
<code>confidence_level</code> = confidence level as a decimal (e.g., 0.90, 0.95, etc)</li>
<li>
<code>number_repetitions</code> = number of simulated samples to generate (should be at least 1000!)</li>
</ul>
</li>
</ol>
<!-- to make pretty someday.... --><!-- ```{r catstats-sum-prop} --><!-- catstats_prop_table <- tribble( --><!--   ~name,    ~description, ~arguments, --><!-- "one_proportion_test",  "Simulation-based hypothesis test for a single proportion", "probability_success = null value", --><!-- "",  "", "sample_size = sample size ($n$)", --><!-- "",  "", "number_repetitions = number of simulated samples to generate", --><!-- "",  "", "as_extreme_as = observed statistic", --><!-- "",  "", "direction = one of: `greater`, `less`, or `two-sided` to match sign in $H_A$", --><!-- "",  "", "number_repetitions = number of simulated samples to generate", --><!-- ) --><!-- catstats_prop_table %>% --><!--  kable(caption = "Summary of `catstats` functions for simulation-based inference for proportions.",  --><!--     col.names = c("Function Name", "Description", "Inputs")) %>% --><!--  kable_styling() --><!-- ``` -->
</div>
</div>



<div class="chapterintro">
<p>Coming soon!</p>
</div>
<!-- ::: {.underconstruction} -->
<!-- Divide up the content in this chapter and move across Chapters 17-19 -->
<!-- ::: -->
<!-- ::: {.underconstruction} -->
<!-- Old content - revise as needed -->
<!-- ::: -->
<div class="chapter-nav">
<div class="prev"><a href="inference-two-props.html"><span class="header-section-number">15</span> Inference for comparing two proportions</a></div>
<div class="next"><a href="inference-one-mean.html"><span class="header-section-number">17</span> Inference for a single mean</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#inference-categ-applications"><span class="header-section-number">16</span> Applications: Infer categorical</a></li>
<li>
<a class="nav-link" href="#making-tables-from-raw-data">Making tables from raw data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#simulation-based-inference-for-one-proportion">Simulation-based inference for one proportion</a></li>
<li><a class="nav-link" href="#simulation-based-inference-for-difference-in-two-proportions">Simulation-based inference for difference in two proportions</a></li>
<li><a class="nav-link" href="#theory-based-inference-for-one-proportion">Theory-based inference for one proportion</a></li>
<li><a class="nav-link" href="#theory-based-inference-for-a-difference-in-two-proportions">Theory-based inference for a difference in two proportions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#catstats-function-summary"><span class="header-section-number">16.1</span> catstats function summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/MTstateIntroStats/IntroStatTextbook/blob/master/16-categorical-applications.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/MTstateIntroStats/IntroStatTextbook/edit/master/16-categorical-applications.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>

  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Montana State Introductory Statistics with R</strong>" was written by Stacey Hancock, Nicole Carnegie, Elijah Meyer, Jade Schmidt, Melinda Yager. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
